# .github/workflows/deploy.yml

name: Build and Deploy to GitHub Pages

on:
  push:
    branches:
      - main # å½“ main åˆ†æ”¯æœ‰ä»£ç æ¨é€æ—¶ï¼Œè‡ªåŠ¨è§¦å‘

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest # ä½¿ç”¨æœ€æ–°çš„ ubuntu ç³»ç»Ÿç¯å¢ƒ
    steps:
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v3 # ç¬¬ä¸€æ­¥ï¼šæ‹‰å–ä½ çš„æºä»£ç 

      - name: Setup Node.js ğŸŸ©
        uses: actions/setup-node@v3 # ç¬¬äºŒæ­¥ï¼šå®‰è£… Node.js ç¯å¢ƒ (Hexo éœ€è¦)
        with:
          node-version: '16' # æŒ‡å®š Node.js ç‰ˆæœ¬

      - name: Install Dependencies ğŸ‘¨ğŸ»â€ğŸ’»
        run: npm install # ç¬¬ä¸‰æ­¥ï¼šå®‰è£…åšå®¢çš„ä¾èµ–é¡¹

      - name: Build ğŸ—ï¸
        run: npm run build # ç¬¬å››æ­¥ï¼šæ‰§è¡Œæ„å»ºå‘½ä»¤ (é€šå¸¸æ˜¯ hexo generate)

      - name: Deploy ğŸš€
        uses: peaceiris/actions-gh-pages@v3 # ç¬¬äº”æ­¥ï¼šä½¿ç”¨ä¸€ä¸ªä¸“é—¨çš„éƒ¨ç½²å·¥å…·
        with:
          # è¿™ä¸ª token æ˜¯ GitHub Actions è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œæœ‰æƒé™æ¨é€åˆ°ä½ çš„ä»“åº“
          github_token: ${{ secrets.GITHUB_TOKEN }}
          # è¿™ä¸ªæ˜¯æ„å»ºå¥½çš„é™æ€æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼ŒHexo é»˜è®¤ä¸º public
          publish_dir: ./public
          # è¿™ä¸ªæ˜¯ç›®æ ‡ä»“åº“ï¼Œä¹Ÿå°±æ˜¯ä½ æœ€ç»ˆè¦éƒ¨ç½²åˆ°çš„åœ°æ–¹
          external_repository: zjncs/zjncs.github.io
          # è¿™ä¸ªæ˜¯ç›®æ ‡ä»“åº“çš„åˆ†æ”¯
          publish_branch: main
          # éƒ¨ç½²æ—¶ä½¿ç”¨çš„ç”¨æˆ·å
          user_name: 'github-actions[bot]'
          # éƒ¨ç½²æ—¶ä½¿ç”¨çš„é‚®ç®±
          user_email: 'github-actions[bot]@users.noreply.github.com'
          # éƒ¨ç½²æ—¶çš„æäº¤ä¿¡æ¯
          commit_message: 'CI: Deploy static files'